$(function () {
    var Menu = function () {
        var self = this;

        var init = function () {
            self.setAnchor(jQuery.url().attr('anchor'));
            self.loadContent();
            pollAnchor();
        };

        var pollAnchor = function () {
            var cur = new Anchor(jQuery.url(document.location).attr('anchor'));

            if (self.anchor.path != cur.path) {
                self.anchor = cur;
                self.loadContent();
            }

            $.doTimeout('poll-anchor', 250, function () {pollAnchor();});
        };

        this.setAnchor = function (anchor_tag) {
            anchor_tag = anchor_tag ? anchor_tag : 'one';
            anchor_tag = anchor_tag.split('#').reverse()[0];
            this.anchor = new Anchor(anchor_tag);

            document.location.hash = this.anchor.toString();

            return;
        };

        this.loadContent = function () {
            $("div.content").addClass("nodisplay");
            $("div#" + this.anchor.path).removeClass("nodisplay");

            
        };

        init();
    };

    var menu = new Menu();
}
);